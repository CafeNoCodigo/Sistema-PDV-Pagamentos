package com.minhaloja.sistema_pagamento.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import com.minhaloja.sistema_pagamento.model.Produto;
import com.minhaloja.sistema_pagamento.util.Conexao;

import javafx.collections.FXCollections;
import javafx.collections.ObservableList;

public class VendaDAO {

	public ObservableList<Produto> listarProdutos() {
        ObservableList<Produto> lista = FXCollections.observableArrayList();
        String sql = "SELECT codigoBarra, nome, categoria, estoque, precoVenda, precoMestre, precoCompra, "
        		+ "referencia, loja, fabricante, fornecedor, imgQrCode, modelo, codigo, garantia, cor, infoAdicional, imagem FROM produtos";

        try (Connection conn = Conexao.conectar(); PreparedStatement stmt = conn.prepareStatement(sql)) {
            ResultSet rs = stmt.executeQuery();
            while (rs.next()) {
                Produto p = new Produto();
                p.setCodigoBarra(rs.getString("codigoBarra"));
                p.setNome(rs.getString("nome"));
                p.setCategoria(rs.getString("categoria"));
                p.setEstoque(rs.getInt("estoque"));
                p.setPrecoVenda(rs.getDouble("precoVenda"));
                p.setPrecoMestre(rs.getDouble("precoMestre"));
                p.setPrecoVenda(rs.getDouble("precoVenda"));
                p.setPrecoCompra(rs.getDouble("precoCompra"));
                p.setReferencia(rs.getString("referencia"));
                p.setLoja(rs.getString("loja"));
                p.setFabricante(rs.getString("fabricante"));
                p.setFornecedor(rs.getString("fornecedor"));
                p.setQrCode(rs.getBytes("imgQrCode"));
                p.setModelo(rs.getString("modelo"));
                p.setCodigo(rs.getString("codigo"));
                p.setGarantia(rs.getString("garantia"));
                p.setCor(rs.getString("cor"));
                p.setInfoAdicional(rs.getString("infoAdicional"));
                p.setImagem(rs.getBytes("imagem"));
                
                lista.add(p);
            }
        } catch (SQLException e) {
            System.out.println("Erro ao listar produtos: " + e.getMessage());
        }

        return lista;
    }
}
