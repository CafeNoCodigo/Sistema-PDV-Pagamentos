package com.minhaloja.sistema_pagamento.controller;

import java.util.Map;

import com.minhaloja.sistema_pagamento.dao.VendaDAO;

import javafx.fxml.FXML;
import javafx.scene.control.DatePicker;
import javafx.scene.control.Label;

public class telaRelatorioController {

	@FXML
	private DatePicker datePicker;

	@FXML
	private Label lbJan, lbFev, lbMar, lbAbr, lbMai, lbJun, lbJul, lbAgo, lbSet, lbOut, lbNov, lbDez;
	
	@FXML private VendaDAO vendaDAO = new VendaDAO(); 

	@FXML
	private void initialize() {
		datePicker.valueProperty().addListener((obs, oldDate, newDate) -> {
	        if (newDate != null) {
	            int anoSelecionado = newDate.getYear();
	            Map<Integer, Double> totais = vendaDAO.buscarTotaisPorMes(anoSelecionado);
	            limparLabelsTotais();
	            atualizarLabelsTotais(totais);
	        }
	    });
	}
	
	private void limparLabelsTotais() {
	    lbJan.setText("MZN 0.00");
	    lbFev.setText("MZN 0.00");
	    lbMar.setText("MZN 0.00");
	    lbAbr.setText("MZN 0.00");
	    lbMai.setText("MZN 0.00");
	    lbJun.setText("MZN 0.00");
	    lbJul.setText("MZN 0.00");
	    lbAgo.setText("MZN 0.00");
	    lbSet.setText("MZN 0.00");
	    lbOut.setText("MZN 0.00");
	    lbNov.setText("MZN 0.00");
	    lbDez.setText("MZN 0.00");
	}

	private void atualizarLabelsTotais(Map<Integer, Double> totais) {
	    lbJan.setText(String.format("MZN %.2f", totais.getOrDefault(1, 0.0)));
	    lbFev.setText(String.format("MZN %.2f", totais.getOrDefault(2, 0.0)));
	    lbMar.setText(String.format("MZN %.2f", totais.getOrDefault(3, 0.0)));
	    lbAbr.setText(String.format("MZN %.2f", totais.getOrDefault(4, 0.0)));
	    lbMai.setText(String.format("MZN %.2f", totais.getOrDefault(5, 0.0)));
	    lbJun.setText(String.format("MZN %.2f", totais.getOrDefault(6, 0.0)));
	    lbJul.setText(String.format("MZN %.2f", totais.getOrDefault(7, 0.0)));
	    lbAgo.setText(String.format("MZN %.2f", totais.getOrDefault(8, 0.0)));
	    lbSet.setText(String.format("MZN %.2f", totais.getOrDefault(9, 0.0)));
	    lbOut.setText(String.format("MZN %.2f", totais.getOrDefault(10, 0.0)));
	    lbNov.setText(String.format("MZN %.2f", totais.getOrDefault(11, 0.0)));
	    lbDez.setText(String.format("MZN %.2f", totais.getOrDefault(12, 0.0)));
	}

}
